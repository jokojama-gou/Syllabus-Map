# SFC 教室利用状況可視化ツール (Map Generator)

SFC（慶應義塾大学 湘南藤沢キャンパス）の授業データを基に、教室ごとの利用状況を可視化した地図画像を生成するPythonツールです。
シラバスデータ（CSV）と教室のレイアウト情報（SVG）を読み込み、指定されたベース地図上に授業名や担当者名をマッピングして、時限ごとの画像（PNG）を出力します。

## 概要

- **シラバスデータの取り込み**: CSV形式の授業データを読み込み、曜日・時限ごとに整理します。
- **ベクター形式の教室マッピング**: SVGファイルのパス情報を解析して、不整形な教室（κ棟など）の形状も正確に塗りつぶします。
- **透かし（Watermark）処理**: 生成された画像に著作権保護や識別用の透かし（氏名や時限情報）を自動的に埋め込みます。
- **GUIファイル選択**: 実行時にファイル選択ダイアログが表示されるため、コマンドライン引数を覚える必要がありません。

## 必要要件

- Python 3.10 以上
- 以下のPythonライブラリが必要です:
    - `pandas`
    - `Pillow` (PIL)
    - `rich`
    - `svgpathtools`
    - `numpy`

(Windows環境の場合、日本語フォントとして `YuGothM.ttc` や `meiryo.ttc` を自動的に探して使用します)

## セットアップ

このリポジトリをクローンした後、必要なライブラリをインストールしてください。

```bash
pip install pandas Pillow rich svgpathtools numpy
```

## 使い方

1. **データの準備**: 以下の3つのファイルを用意してください。
    - **ベース地図画像**: キャンパスや建物の間取り図が描かれた画像ファイル（JPG/PNG）。
    - **シラバスデータ (CSV)**: `科目名`, `担当者名`, `教室`, `曜日時限` のカラムを持つCSVファイル。
    - **教室レイアウト (SVG)**: 各教室のエリアをパスとして定義し、IDに教室コード（例: `kappa23`）を設定したSVGファイル。SVGファイルは、GIMPなどでベジェ曲線で教室の形状のパスを描き、IDを教室名に設定してパスだけエクスポートして保存して作成することができます。

2. **スクリプトの実行**:

```bash
python generate_maps.py
```

3. **ファイルの選択**:
    - 実行するとファイル選択ダイアログが順に開きます。コンソール（ターミナル）の案内に従ってファイルを選択してください。
        1. ベース地図画像
        2. シラバスCSV
        3. 教室レイアウトSVG

4. **生成の確認**:
    - 処理が完了すると `sfc_lectures_maps/YYYYMMDD_HHMMSS/` フォルダ内に、各時限ごとの地図画像（例: `map_月1.png`）が生成されます。

## 機能詳細

- **教室コードの正規化**: データ上の「κ23」「Kappa 23」などの表記揺れを吸収してマッチングします。
- **エラーハンドリング**: データ不備がある場合でも、可能な限り処理を続行し、問題をコンソールに見やすく表示します（richライブラリ使用）。

## ライセンス

[LICENSE](LICENSE) ファイルをご確認ください。
