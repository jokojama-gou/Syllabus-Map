### **プロジェクト計画書（詳細版）**

このプロジェクトは、\*\*「①共通基盤」**となるデータを作成し、それを**「②Google Sheets」**と**「③Webアプリ」\*\*という2つの異なるゴールに展開する構成です。

---

### **フェーズ1：共通基盤の構築（データレイヤー）**

両方の成果物の土台となる、最も重要な準備段階です。

#### **1-1. データ抽出 (Python)**

* **目的**: 手作業では扱いきれないシラバスHTMLから、プログラムで利用可能な形式の授業データを生成する。  
* **使用ライブラリ**:  
  * BeautifulSoup4: HTMLの構造を解析し、必要な情報（科目名、教室など）をピンポイントで抜き出す。  
  * pandas: 抜き出したデータを表形式で整理し、複雑な表記（"月1:ε12, 火2:ο13"など）を1コマずつのデータに分解（正規化）するのに使用する。  
* **具体的な処理の流れ**:  
  1. PythonでシラバスのHTMLファイルを読み込む。  
  2. BeautifulSoupを使い、全授業の情報をリストとして取得する。  
  3. 各授業について、「科目名」「担当者」「曜日・時限・教室」の文字列を抽出する。  
  4. 「曜日・時限・教室」の文字列を正規表現などで解析し、「月, 1, ε12」「火, 2, ο13」のような個別のデータに分解する。  
  5. 最終的にpandasのDataFrameに全データを格納し、JSON形式でファイルに出力する。  
* **最終出力 (syllabus.json) の形式例**:  
  JSON  
  \[  
    {  
      "subject": "プロジェクト英語C EC02",  
      "teacher": "担当教員A",  
      "day": "月",  
      "period": 1,  
      "room": "ε18"  
    },  
    {  
      "subject": "朝鮮語インテンシブ１KA",  
      "teacher": "担当教員B",  
      "day": "月",  
      "period": 1,  
      "room": "ε12"  
    }  
  \]

#### **1-2. 地図レイアウト定義 (Google Sheets & 手動)**

* **目的**: 抽象的な教室コード（例: ε18）と、具体的な「画面上の位置」を紐付ける設計図を作成する。  
* **具体的な作業**:  
  1. 新規Google Sheetを作成し、SFCのキャンパスマップの画像を参考に、セルの幅と高さを調整して方眼紙状にする。  
  2. 各教室がどのセル範囲を占めるかを決定する。（例: ε18はA5からC10の範囲）  
  3. その対応関係を、手作業でJSONファイルに書き出す。このファイルがプログラムにとっての「地図データ」となる。  
* **最終出力 (map.json) の形式例**:  
  JSON  
  {  
    "settings": {  
      "columnWidth": 20,  
      "rowHeight": 20  
    },  
    "rooms": \[  
      {  
        "id": "ε18",  
        "name": "ε18",  
        "startCell": "A5",  
        "endCell": "C10",  
        "labelCell": "A5"   
      },  
      {  
        "id": "ι21",  
        "name": "ι21",  
        "startCell": "D5",  
        "endCell": "F8",  
        "labelCell": "D5"  
      }  
    \]  
  }

---

### **フェーズ2：成果物① Google Sheets ジェネレーター**

#### **目的: Pythonスクリプトを実行するだけで、指定した時限の教室マップをGoogle Sheets上に自動描画する。**

* **技術要素**:  
  * **Google Sheets API**: Googleのサービスをプログラムから操作するための「窓口」。  
  * **gspread (Pythonライブラリ)**: このAPIを、Pythonから非常に簡単に使えるようにしてくれるツール。  
* **事前準備**:  
  1. Google Cloud Platformでプロジェクトを作成し、Google Sheets APIを有効化する。  
  2. サービスアカウントという「プログラム用のGoogleアカウント」を作成し、認証キー（credentials.json）をダウンロードする。  
  3. 作成したサービスアカウントのメールアドレスを、描画対象のGoogle Sheetの共有設定に追加する（編集権限を付与）。  
* **スクリプトの処理ロジック**:  
  1. **初期化**: gspreadを使い、credentials.jsonを読み込んでGoogleにログインし、対象のSheetを開く。  
  2. **データ読込**: フェーズ1で作成したsyllabus.jsonとmap.jsonを読み込む。  
  3. **時限の指定**: スクリプト実行時に「月曜日の1限のマップを作って」のように指示を受け取る。  
  4. **シートの初期化**: まず、Sheet上の全ての色と文字をクリアし、まっさらな状態にする。  
  5. **描画ループ**:  
     * 指定された時限に行われる授業をsyllabus.jsonから全て探し出す。  
     * 見つかった授業の教室コード（例: ε18）をキーにして、map.jsonから描画すべきセル範囲（A5:C10）を取得する。  
     * gspreadのコマンドを使い、そのセル範囲の背景色を指定の色に変更する。  
     * 同様に、科目名を表示すべきセル（A5）に、授業名を書き込む。  
     * 全ての授業について、この処理を繰り返してマップを完成させる。

---

### **フェーズ3：成果物② Webアプリケーション**

#### **目的: ユーザーがブラウザ上で自由に時限を切り替えながら、リアルタイムで教室の利用状況を確認できる動的なWebページを作成する。**

* **技術要素**:  
  * **React**: Facebookが開発した、UIを効率的に作るためのJavaScriptライブラリ。「コンポーネント」という部品を組み合わせてページを構築する。  
* **コンポーネント設計（部品の設計図）**:  
  * TimeSelector.js: 曜日と時限を選ぶためのドロップダウンメニューやボタン群。ユーザーが何かを選ぶと、その情報を親コンポーネントに通知する。  
  * CampusMap.js: 地図全体を表示するエリア。map.jsonを基に、全ての教室のdiv要素（四角いブロック）を配置する。  
  * Classroom.js: 個々の教室を表すdiv要素。位置、サイズ、科目名などの情報を受け取り、自分がハイライトされるべきかどうかを判断して色を変える。  
* **データの流れと動的描画の仕組み**:  
  1. **初期表示**: アプリケーションが起動すると、まずsyllabus.jsonとmap.jsonを読み込む。CampusMapコンポーネントがmap.jsonに従って、全教室のdivをCSSの絶対位置指定（position: absolute）で配置する。  
  2. **ユーザー操作**: ユーザーがTimeSelectorで「火曜2限」を選ぶ。  
  3. **状態更新**: TimeSelectorからの通知を受け、アプリケーションの最上位コンポーネントが「現在選択されているのは火曜2限です」という情報を\*\*状態(State)\*\*として記憶する。  
  4. **再描画（リアクティブ）**: Reactが「状態が変わった！」と検知し、関連するコンポーネントを自動的に再描画する。  
  5. **ハイライト処理**: CampusMapに「火曜2限」という新しい情報が渡される。CampusMapはsyllabus.jsonをチェックし、「火曜2限に行われる授業はこれとこれ...」とリストアップする。  
  6. リストアップされた授業が行われる教室のClassroomコンポーネントにだけ、「あなたはアクティブですよ」という特別な目印（props）を渡す。  
  7. 目印を受け取ったClassroomコンポーネントは、自身のCSSクラスをclassroom--activeなどに変更し、背景色がハイライトカラーに変わる。  
* **インタラクティブ機能**:  
  * 各ClassroomコンポーネントにonMouseEnter（マウスが乗った時）というイベントを設定する。  
  * イベントが発生したら、その教室の授業詳細（科目名、担当者など）を持つツールチップ（小さな情報ウィンドウ）を表示する。